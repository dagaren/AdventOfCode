module AoC25

open Utils

type SeaCucumber = 
| HorizontalSeaCucumber
| VerticalSeaCucumber

type SeaMap = {
    map: Map<(int*int),SeaCucumber>
    rows: int
    columns: int
}

let aoc25 () = 
    printBanner 25

    let input = [
        "vv..>.v.v..>..v.>>.vv.vv...vv>v..>..>vvv..v..>..>>...v.v...v...v>v.>v>>..vv....>v>......>>.v...>.>v>>>..v.>>v..v>v>.......>>..>v.v..v>...v>";
        "v.......v.v.>v.>>..v....>.>.>.....>..v.>>v>.>.....v..>v..v>>....v..>v.>.>>.>.>v..v>.vv...>..>>vvvvvv.>v>v.>v.....>......>v.vv..>..v>vv>>>v.";
        "...>..>>.vvv.v.vv>...v..v.v...>...>v>>>>>v>v.>......v...>>.v.>v>.v>.>..>.>.>>>..>.v>>v.>..>>.>...>>..>.v....>>v.vv.v>>>.>.v....>..>v>.>.v..";
        "v....v.v..>v...v>..vv...>..v.vv...vv>.>..>>..>..v>vv>v...>...>.>>....v.v....>>>.>>>>v..v>.>.>>v>>..v>v...v.v>vvv>>v....>..v.>v.>.>.>..v.>>.";
        "v>>...v>v>>....>.>..>..>>vv>..v.v..v.>>>..>v..v..v.>.vv>vv.vv>......v......>....>v..v>>.>..>.v.v>.>>.>.v.>.v>..>.>>v>.vv.>v.v.....v..>v....";
        ".v.v>.v..vv..>.v...v>v..v.>v.>...>..v....v>..>.>.vv...>>v....v>.v>.v.vv.>.>.>....v.v>.>>>.....>......v..v>>v..>>v..v>v>.>..>.v>>>.vv>.>vvv.";
        ">.>>v..>.>>.v>.>..v>..v>..>..v>....v.v.v>......v>>..>>>v.v.v.>>v....>vvv.>>v.>.>>.v..v.>....>v....v>.v>.vv...>>.v..v..v>>..v..>v..>....v.v.";
        "v..v...v.vv.>vv.v....>>>.v>>v.>.v..>v.>..>....v..v.>.>>v>..vv...v..vvvv....>>vvv.>....>...>.v>..v...v.....v>>.v>.....>.vv..>v>.>>v>....v>>.";
        ">..>.>.vvv..v..v.....v>.v>...>.v>....>..v>.v.>.>>>v.....>>vv>.....>>v..>>.vvv>.>.>>.vvv>.vvv>>v.>>.....>..v....vv>.>vv.>v>v..vv.>>>...v..>.";
        "...v>...v..>.v..>..>.v..v.....>.>>>>v.>.>..>>v>>v.vv..>v..>v>.>>.......>>vv.>.v.>..v......v.v>v...>vv>v..vvv..>.vv.>>v>>>..>v..v>>.>.>v..v.";
        ".v.v.>>.>>.v..>...v.>>>v.>>>>..vv.v.vvv>....v>.....>..>......v.vvv..v>>...>.v>..v.>v.v...>.>>vvvv.v..>..v..>vv>.v.v>.vv.v>.>>>vvv..v.v...v.";
        "..>v.v.>>vvv>v..>.......>v....>v..vv.>v...>.>>>..vv>vvvv...>....>....>v>..v>.v.v..>v....>>......v.>..v...v.v...v.vv.>....v.v>v...>>vv..>v>v";
        "v.>..v>....v....v..v..>v.>.v>..v.v>v.v.v.>vv...v.v.v>v>vv..>v>..v>..>.>v>v.v>.>..v....>v.....>.>>.>.>..>.v.>....>>vvvv..>>v>.....>v.>vv.>vv";
        ">..>.>.>..>v>..>>vv>>...>.v>v...v....vv.v>...v.>v.v.....v..>v.>v>..>vvv.>v.v>.v.>v>>v..>.v.v.>>v>>..v..v.>..>>v.v>...>..vv>..>..v...>>.....";
        "...>.vv..v.v>..>.v..>....v>>..>>.vvvv.>..v.>v.vv...>>..>v..vv>>.>..v...>v.v>.>v..>.vvv>vv.v...>v...>v...v>v>v.>v....vv>>....v.>v....>..>vv.";
        ">.>.v>>v>v...>..vv.v.v>...v.v>>...>>.>v>vv..>v>v>.v......>vvv..>.>.v..>vv....v.>.>>vv..>>>.>>.>v>.v....>.....>>>.v.vv.>.>..>v>>..v..v>v.>v.";
        ">...>>..v>v.>v...v.v.....>vv..v.>>.>vv.>>.v.>.>v>v...>..>.>.vv..vvvv>>.>.v>...v.>...>...v...>.>.vv>.>v.vv>..>...........>.>.>..vv>.>vv.>...";
        "...v..>>>.>.vv.v.>v.>......v>>>.v.v>vv.>.>.vvv.v>.v......>v....>..v.>>>>>.>........v.>..v..v...v>..v...>v>vv>v.v....v..>>v>>...v..>>.>.>>vv";
        ".>v.>..vv>...vv>....v..>>v>>>.v.>>>vv>...vv...v.>>..vv...v...>>...>v.....vv>v...vv>.v>v...>..v>v..>>v.v>>vv>.v>..>vv..>.....v>>......>>>..v";
        ".>..>.v.>>>........>.v.v...vv.v....>v.>>>v..>.vv...v.>v...v>.>..>.>v..v....>...v>>...v...>.v..>..>.>>.>v...>..>...>v>..v>..>.v>v>v>..>v>>..";
        ".v..>..v.>v.>..>vv..v...>..>>v..vv>.>.>.>.vv....v.v......>v...v..>>...v>v>..vvv.>v..>...v>v.>....>.vv...v....v.>.>>.v>>v>....>>.>..>..>.>v.";
        "...vv....>>..>....>...v.....>.>.v.>vv.v>>.>.>>v.vv..>....vvv....>>>......>>.v.>.v.>>v>.vv>>.v>>>v.>>.>.vvv>.....v..>.>>.>..>>...>v...v>..>.";
        ">>vv...>.v...v.>.>v..v>>.v>>.v..vv......v>.>>v..v...v..vv>>>....>>v...v.v..v>>>.vv.....v>....v..>>...v>>v..v....v.>...v.>..>>v.>.v.>v.v..v.";
        ">..>>.......v..v>..>.v>....>..v>v.v>>..vv....>>..vv..vvv.v>..>..>..>.v.v.>>.>vv.>.v>..>.v>..>.v..>v...v.>v.vv>v..v..>.>>.v.vv.v>...v...>..v";
        "v.v.>..>.>vvvv.>>..v.>.v...v>.....>..>v.>...........>v..v>.v..>.v....vv>.>v.vv>>v.>.>>..v.v.>.vv...>>.vvv>.>....v....v..v..vvv.>v.>v..v..v.";
        ">v.v.v..>v..>..>vv.......>...>.vvv..v....>..>v>.v.v.v.v>>>.v>..>>v>..v.>v....vv>.v..>.v>v>>..>v.v.v.v..v>.v>v.>..v>.>>.v.....>...>.>vv.>v.>";
        "..>.........>v>>..v.>>vv.v.vv...>v.vv...v>v.>>.v.v>..v>.vv.vv.>......v.>.>v.v>..vv..v.v>>.>>.vv.vvv...>.v.v.>.v>>...>v..>..>.>v>vv>vv..>>.v";
        ".>>...>.>>vv>v>>.vv>>.v..>v...v.>.v.....v...v..>.>....>v.........v..v>.v.v>>.v.>vv>..>v>.v>v.>..>..>.>.>.vvv.vv>>..vv.>.vv....>>vv.vv.vv.v>";
        "v...v.v..v>.>>..vvv.>.vv.v.>.>v..v..>.vv...vvvv..>..>>>v.>>..vv.vv....v..v>..>.v>v...v.>v...>v.v.>>>>v...vvv..v.>v>>v..v.>.vv>>>.vv>..>..v.";
        "..>>>.v>.v>...>v.v>..v....>v>.>.v>..v..>..>>.>...>v>..vv...>>.v..>vv>.>>..>>v..>vv..v..>v.>v>vv..>>>v..v..>v>v.>.v>>...>v....>..v>.v.vv..>.";
        "v.>>.vvv>v.v...vv..>.vv>v..v.v..>>....vvv.v>.>vvv...v>...v.....vv>v.v..v.>>>.>vv......v>>>.v>.v...vv>.v.v..>>.v.>v..>vv>v.vv>.>.v>......vv.";
        "..>..>v.v>>......vv..>.v>....v.>>>.>..v.>.>.>.v>v.>v>.v.v..>.v.v.v.v.vv.>...v..>v>v>.v>v.vv>...v.>v..>v.>>v...v>..v..v.v>v.vv.v.vvv.....v.v";
        "..v.>vv>.v..v.v......vv>.v.>......>..v>v.v..>v.vv>v..v>...>....>..v>...v.>v.>v>v>.v.>>v.>>>vv....>.>....v.>>.>.>.v>>v..>...>vv..v.vv>vv.>v>";
        "v.v...v.>v....>..>>....>v>.v>..v..>..>>>>.vv.v>..vv.>.>.>..>.v.vvv..>...v.....v>v..v>>.>>.v.......>v...vv.>vvv.>>....>>...>>.>vv...>....v>v";
        "v..vv>>.>>...v....>.>.>vv>v>>>>..v..vv>....>>v.>..>>..>.....>>>>vv...v>vvvv>>>.v>v..v..vv.....v.>.>>.v>..v..>v..>>>.v.v>..v.>>.vv..v>..>vvv";
        "v..vv>>>v>....v....>v>vv>.v..>.>vvv>>>>vv..v.....v....vvv..vv...>>.>...v...vvv>.>.v>v.vv.v>.>>...>>..>.....v.>..>v..v...>.>>..>>.>.>...v>..";
        "v..>..vv>>.vvv>..v...v.>..>>v.v.vv.>..v.>>v>.v>.v...vv>>v>.v.>.>.v>.>...v.v>.v..>vvv>>>v.vvv>v>v.>..>...v>.>v>...>>>....>>.>..>..>.>.v.>.>.";
        ".vv..v>..>..>.>v.>.>v.v.>.vv.>v.>...v.vv>>..>>.v..>>>.v>.vv>.>v.v.v....v>.v>.>.vv>.>>......vvv....>>..v>v.vv>v.v.>.v>v..vv.v...>>v>vvvv.>..";
        "...v.>..>.....v>.v>.vvv>v.v..>>v...>....v..v.v..>..v...vvv>..v..>..>.v>>>.....vv..>.>...>>v>>vv.>>v>.>v.>>>.>v>>>vv...v>.>.v>>>v>..v.....>.";
        ">.v.v.v..v..>...>...v.....vvvv..>>v..vvvvv>>v...v.v..>>>.>>vv>...>>.>>vv....>...v.vv.>..>v>.v>>..>v.>.v..>.>..vv>>.>.....v>v>.v>v>v..v..vv.";
        "..v..v.v.vv>.>>>..vv..v>.>.>>>...>....v.v...v..v....>.>v..>.>>...vv>>...>v.>.>>.....>>v....>..>>vvv...vv.v..v..v>..v>>.>.v..>..>..vv....>>>";
        "v.....>v.v........v>v.vv.v.>..>>.>...v...v..vv>....>..v.>.>v.>.v..v>..vv....>.v>>..>.vv>.>.>.v...>.v.>....vv>....v>v.vv>.>......>>.v..>>>vv";
        ">v....>>v>...>v.>v.>v...v...vvv.v..v>v...vvv.v>>v.vv.v...v>.>..v...vv.vv>.>v>>.v>.v..v>v>>>.vv>.v..vv.v..v.v>v..vv>.....>...>>v...v>>..v.>.";
        "v...v..v..>...>.>.v.v...>>>...v...>vv.>.>...v>>.vv...vv.v.>v.>..>v.>..v.v>vv>v.v>vv.>..>..>..>>vv>v>>....>>............>.vv.>v>...vv>>v..>.";
        "..>>v>>....>...>.vv.v.v..v..>>>.>..vvv...v.vv>...>..>>.>....>>.......>.>v.v....v.vv>..>....>..v.vv..>.>>v>.v...vv.>.v>v>>...>v.>.v..v.....v";
        ".>v>.vv..v...v>.>v>>..>vvvvv.>>..>..>.v.>.v.>.v......>.>>>>.......vv.>v.v...vv.vv>.v>v.>.>.>>v.>v....>>vvv...>..v...v>>........v......>.>.v";
        ">vvv..v>>.v>>.>.>>vv.>..vv...>.......v..>>>v...v.....v..v..>..>>v...v>.>>>.>>>v.v.......>..v.>>>v>>.>>>v>.>>.>..>.>.....>.>.v..v.>v>.>>..vv";
        ".v>.v>....vv.>v..>..v>>.v>v.v>v.>..v>.......>v..v..>vv..>.v...v..v>...vv.......>>>>...v>.v.v.>>v...v.>vv....>v..>vv..>.........vv>..>v..v.v";
        "...vv.>.vv>>>>v>......>>.v.>>..v..v.vv>v>..v.>.>>>..>..vv>..v>..v....v..v>v..>.>v...>..v.>.>.>.v.vv>vvv.vv.v.>..>.v>...>v..v>v>.>.>.vv.>>.>";
        ">>.>>...>vvv..v..>v>.>>.....v..vv..v>vv.v.vvv..>>>vv>v.v>...>v.v>>>.vv>.vvv..v..v>v..vv>.v.v...v.......>.v...v>v.>...>vvvv..>.>>...>>.>v.vv";
        "..>..>v..>.>v.>vv....vv.>..>vv.v.>.>..>>..vv>.v....vv>.v.vv.>.v>.vv.vv.>..v.v...v....>vvv>>v>.>v>>v>.>...vv...>....>v......v>.v.vv>.v.>v.v>";
        ".v.....>.>.v.>v...v..........>.>.>.>.>.v.>>.vv...v.>..vvv>v>v>>...>>vv.>vv..>.>>.>v>.v.>..>..v>v..v>>....vv.>vv>..vv....v>>.v.vv.>..v...>v.";
        "vvv>.>v.>v.....>..vv......v>>v>>.v.v>.>.v.v....>.>>.>.>.>v.vv.>v>>..v>.v..v.>.....v..vv..v>..v.v>.vv..v>.>.>>.vv>.v>vv.v>>v>.>...v>>v...v.>";
        ">>.>vv..>.>.>v.v>vv>v..vvv.v.>.v.>>>>.......>vv.v>v..v>.>>>..v>...>.v.v.v.>.>.vv>...v..>.>.......>.vv>>>.>.v.>...v..>>v....>.>.v>>vvv......";
        ".>>v.>v>.>vv>>..v>.>v>..>>>>.>v.>.>v.v.v..>>.v.v....>.>>..>vv.v>>..>.>>v.>vvvv>v......v.v>..v.vv>>.v>..>.v>vv>.vvv>.>>>>.>>.v>>.>...v>..v.v";
        ".>vv..v.>.v.v...>....v.v.>>.>...>..>v....>....>>>.>.vvv>.vv.>v...v...>>v.>>.>.v.>>.v.>.>.>.v.v>....v.v>>...v>>..v...>v..v...v......v.>..v.>";
        ".vv....>.vv.>...v>>...>v..>>v...v.v...v>v..v>vvvv>.vv.>v.v>.v......>v.vvvv..>..>v...>.vv...........v>.>>v>.....v>.vv>v..vv>.vvv.v..>......v";
        "..v...>.>.>v....vvv..vvv.....>.vv...>v.>v.v.v.v...>.>>>v.vv>v.>>>..v..>v>..>vvv>v.>v...>v.v...>.>..>...>v>.....>.>..>vv...>.>>>>.>.v.>....>";
        ".>...v...>v.v...>>.>v>v..v...v..>.v..vvv.v.>v.>vv..v>..>.v.v....v.....>.>..v>....v>......>.>>.>...vvv..v>..>...v.......>v.>>v...>>>..vv>..v";
        ".v..v....v.v..v>.>v>..>..>.>....v>vv>>.>>>>>...vv.....vvv.>.>>..v>..>..>>>>..v.......vv...>>..>>v...>>...>.>v...>vv.>v>..>.>v.v>...>>v...v.";
        "v..v>.vvvv>.>v.>>.v>.......>...v>vv.v>v...vvv...>.v>.v>.v>.>>.v>v.....>..v>..>>>..v.v.v>vv..vv.v......v>>>v.>..v..v..v..>.v..vvv.>....v..>v";
        ">...v.......v.>vv..vvvv>v>>.v.>v.>vv...>>...v.>>v...vv.>>>.>>..>>.>v.>>...v.vv.v...>.>.v.>>v>..v>>.>>.>>...>..v>v>v....v>vv..>v.>>.....v>>>";
        "..>v>vv>>>.v.v..vv>>v>v..v....v>>>.>>..>.....v.>....vv>>v>vvv>.v..>v.vvvvv>...>v>.v....v..v...>.v..>vv...v>v>v.>..>...>>>>.v...>v>>...>.>v.";
        ".v.v>..v....>vv.vv..>vv....v..v....>>vv>.vv.>...v.....v>v.>v>.v..>..v>.vv..>v......vv>>.......>.v.vvvv..vv>>.>>.>>.>v..>vv>...v.....>>vv.v.";
        ".v>.vv.v....v>v>.....v..>>.v......>v..>...vv.>v>v..v>.>vvvv>..vv.v>>vv>>v>>.>v..>.v.>.>vvv...v.>.......>v...vv>vvv>.v.....>.vv.v......v>v..";
        ".v>>v...>v....>>...v.v>v.>...v.>...>.>v.v...>v..>..v.>..v.>>.......>>vv>..>v.v.>>v>...v......>.>v.....v.>v..>>v>>>vv>......vvvv.....v..>v..";
        "v>v...>.v....v.>.>>vv.>v.v....>>.>....>..>.vv..v..v>v.vvv>.vv>...v>v..>...v.v>v.vvvvvv>vv.v..>v...v>v>v.>..>>.>..vv....>..v...v>.v.>.v..>..";
        "vvv.>v...v>v..v.>v..v..v.v.v.v>v>.>.v>..>...vv.>v..vvv.....>..v.>.vv..vv>.vv>.>..>>>..>..v>>>.>.v>>>....v..v..>vv>..>....>>v.v...>..vv>v.>v";
        "v..vv.v>.v.....>>>v>...vv.vvvv.>.>>..>.>.v..>.....v......>.>>.v..v>v.vv>..>v..vv.v>v>.vv...>.>vv>v..v...vv...>>vv..v..>>v.>>.>vv>>.v>.>.>..";
        "...v....>>vvv>.v..v..v>v.vvv..........>..>.>>.>>.>>.v....v>..v>..vv...v...>vv.>...>....v....v.v.>>.>.......v...v..v>.>>>.vv.v...vv>v..v.>>v";
        "v........>>.v....>..vv.>v.>.v.>>.>>.>>.>.>v.v.vvvvv.v.>v.v..v.>>....v...>v>>.v...v.>>..>>v.v.....v>.>v.v>>>v..vv..v.>..>v>..v...v>.>>v..>..";
        ">.v..>.>.v>..v..>v.>.v.v.......v....vv......v>v...v.>...v>.>.v>...>>.>..v.....>.v.......v.>...>>>...v.v....>.v>>>v.v..>>>..v>..>vv.>>..>...";
        "v>>.>>.>>.>...v..v...vv>>v.>.>v.v..v>..>..>....>..v.v>.v.v..v.v....>>v>vv>.v.v.vv>.v..>.v>>..>.v...>v.vvv>.>>v......v...>.>....v>.>v>v>.vv.";
        ".v>v>.>v..v.>....v.....vv..v>>.vv.>.>..>..>.vv.v>....>.>...>...>vv....>..vvv.v..v.v..v>>v>v.>>v.v.>....>>..v.v>v.>.v...v.v.v>>...v.v...>..>";
        ">>v.v.>.>...v>>>...>.v>>..>>vv.......>vv>>v..v.v......v.vv.>....>vvv>>vv.v>.>vv>v....>...v..v..>..>vv>..>>v>...>..>.vv...>.>v........v>v...";
        ".>...>.v.v>>..v..>.v>vv..v>>.vv..>>...>v>.v.v..v.>.>.........>>...>vv>>>.v>vv>>.v>.vv>.v..>.........>>v..>v>.>>>v..>>>.>.>v>.v.>.v>.>v....v";
        "..v..v>.v>.v.v>>>>.vvv.>....>vvv.v.........v.v.>..>..vv>.......>vv>v....v>..>.>v>v>>.>>.........>.v..>.v..v.>>v>>>v>.....>.........v....v..";
        "....>>vv.>.>.v.v>v>>..>v>.>..>v>.....v>....>v...>vv..>.....>.v..v.vv>v>>v>.v.>>..>vv..vvv..vv..>.>>.v>>.>v..>vv..>......vv.>v>....>v>..>vv>";
        "....>>..v...>.v>....v>v...>...>....v...>v>v..>..v.vv....................>v>..>.v>.>.>>>vvv>...>.>v>.>.>....v...v.>.>.v...v...v..v>v....v..>";
        ">...>.v..vv.v.vv>.v...>vv......>v......vv......>>.v.>........vv.v>v.v>.v>.v.....>>v...v..>.>>.>.....v...>.v....vvv>>>>..v.>.>....v.....>..v";
        ">>.v..>>...v>v.>v.>.>..v....>>v..vv.v.vv.>...vv..>>v..>v>>>.v>....>....>v..v.>>..>..v>.>vv.v..>>>......v.>v.vv.>>>..v>...v.v>vv.v....>>....";
        "v>.>vv...v>>.>.v..vv.>..>>>.>.>.>.>.>>..>v.v..>v.>v.v>..>..vv.....>v.v...vv>>v.vv>v>...v>..vv>.v>>.>vv......v..vv.v.>v>>>....>.v..>....>>>.";
        "..vv.....>.v..v>>v>.v>...>..v.....v..v.>>>>..v.v>.vvvvv.vv.>..>>>>>>.>..v>.>vv>v.>v.>.>v....v.......v.>>.v.>.vvv...vv.v>....>.v>>.v.v>..>>.";
        ".>.......vvvv......>.>...v>v>>>.vv>v>.v>....v.>.v...>>>..>..>>.>vvv.....v.>.>v.vv.>.>..v>>.>.>.>.>..v.>.>>v.vv>.v.v.>v.v....v>v>>..>.....>.";
        ".v...vv.vv..vv..v...>.>..v>v>vvv.>>vv.>vv..vv>>...>.vvv...>>v.>v....>>.v...v>..>.>.>vv.>..>>v...>.>...>v>..>>>v>..>>.>v....>....v>>>...>vvv";
        ">vvvv.v..v..>>.vv.>>>..vv.>vv>>......>v.....v>......vv>vv>v>>v>..>.vv>>...>v.>v.vv>.v>.>>...>..>>>..vv...vv.v.v...>>v>.>>v.vv.....>.v>>>>>>";
        ".>>vv>v..vv...>.vv>...>...>...vvv.vv......v>..>.>>.v...vv>v>>>v......>..v..>v.>...v>..>......v>..v...>.....>vv>v..v.v>..>v>..>.>v.......>.>";
        ".>...>>...v....v.>vv>>.v.>.v.....v.v>>.>.>..v..v>.v.v..v.>.>>.v>..>>v.>.v.v>..>.v>>v.>.....v.>>>v.>.v.>v>.>v...>...>v....>..vv.>.>vv..v...>";
        ".v..>>.>..v.v>v.v>.v.v....vv>.v...vv..vvv>...vv.v.v..v...>>.>...>v>>>vv.>..v>..vv>v..v.vv.>>.v>..v.v..v.v.>>>.>.>v>...v......>..v...>vv>>>>";
        "....>.v>.>v>v..v.v..v.v..vv.>...vv>>.>vv.>v>>>..v.v.>.vv>...>.v.v.>.vv...v.>....>vv>>....v.v.v>v.>>....vv...>..v.v...vv..>>.v.v.v>v.>....>>";
        ">....v>.v.vv>.>>>v...v>..>..v....v..v....>.v....v.>>..vv.vv.>>>..v.>>>vv..v...v>>v>>..>.>.v....v>.vv..>v>v....>.>>v.>..v...v.>v.vv.v>....>.";
        ">v>.vvv..v...>>.>>.v....>.v>vv>v...>v>..vv..v...vv>.>.>..>>.>..v.v>>>.v>..vv.>v..>>v>>>>.>...v>v.>....v.>>.v>..>>v>.v.>>.>..>.>>>>.>v..>..>";
        "v.>..>..>.>..>.....v>..>vvv>v>..>>..>.v.>>>......>v>....v>>.v..v.v>..>v....vv>v>>..>>.>>.v>..v.>.>v.v.>...v>vvv>.v.>.v...v.......v.v.v..v.v";
        "v>.vv...v...v.v.>v>...v>>.>.>.>vvv.v....vv.v..vv...vv>>>>.>.>.....>>......>vv>>...vv.>>>>v>.>..>>..>..vv..v>>v.vv.>..>.>v>>>>.>..>......v..";
        ">>>.....>..v>v.>v>...vv.v>...>v..v>>>....v.v.....>...vvv>v..v.>.....vv.>.....v....v>.v.>..v.......>....>>..>.>v>>.....v>>v.>vvv>v>>>>>...v>";
        "v.>vv>>vvv>..>>..>.>.v..v.v.vv>....v..v.vvv..v.v.>v>.>..v>>.>.vv>.v.>v.v.>.v.>>.v.v...>v>v.v.....v>>..>..v.>.v.v.v...v..vv..v..>...v....>.>";
        "......v.>..>vv.>v...>>>...>.vv..v>..>...vv>>.v>>.v>>v...v>..>....>v..>.>....v..vvv>v...v.......v>v....>..v.v......>...v.>v...>..vv.>.>>..v.";
        ">.....>.>vv....v..>....v.v...>v...v..>.v>..>.v.....vvv>....>v.>..v....v.>.v.vvvv..v..>v.....>.>v>v.>>vv>...vv..>..v...v>>v..v>>v.>...>>>.v.";
        ".>>vv...>>.v..>.>v.v..>>v.v..>>>..>>.....v........v>..>v.>vv..v.....vvv.v>v.v....v>.....>....>>..vvv.>...vv.>>.>.>.>v.>v.v>......>v..vvv.v>";
        ".v...vvvvv......>>v....vv...>v>v>..>...>v>vv.>..>....v.v...vv..v.vv..>.>v.>v>.......>.>.v>.v>>v.>v.>..>.>..>v.>>v..>...vv.vv>.v>>v.>>...>v.";
        "...v..v>vvv...>v.>...vv.>vv.v>>v>...>.v.>..>...vv..v..v..>>>>...v>.vvv.vvv.>v......v.>v..>....>>...v>.>>>..>vv>.>..v>.v>.v....v....>vv..>.>";
        "...>.>.....v....>.v>>...>.vv..v..vv..>>>v..vvv.>>.>..vv.>vv.>..>...v.v>.v..>>v.>...v>>>.....vv...>v.>vv>>..v.>.v.>.>..v>>.v>v.>v>v>.v>.>>>>";
        "v>>.>v..>.>.>...>....>..v....v.v>>v........v..>.vv.v>>>.v>..>>>>..v....>v.v>.>...>>....>..>vv......>......>>.v....>.v.>v>.>.v..>...>....>>>";
        ".>vv>.>..vv..>.>vv..vv.vv..v.v...>..>.v.v.v>......>.v......>..v>...v.....v>..>.>>>v.v..>..>..>.>v.v>..>..>....vv.vv.....v>....v.>.>>v>..v.>";
        ">>..>vv>>.v.>>>.>.v...>...>v....vv.vv>vvv>..vv...>.v>>>v.v...>>.....v>vvv>v.>>>v.....v.v...v>>>..>.v...>vv.vvv.v.>...>v>.>>........vv.>>>>.";
        ".>.>>.v>..>>.>..>>.>>....v..>..>v.v>>>.>vv.>.v.v..vvv......>.>..v..>.....v.v.v.>.>v..>>....>v>..vv...vv..>....v>>v>v.v..v..>..>.>.vvv>>.>.>";
        "..v..vv..v>v.>..>>.v.v.>v.vv>>..>v..>>v...v...>v>.>.v>..>.>..>v>>v>>>.v>...>....>v.>vv>>>.v.>....>..v>v.v..v..>..vv...>>....v...>.v>.v>vv..";
        "....v...v..v>.>.>v..v.v..>>>>.v.vv.v>.v.>.vv.v...v..>..>v>v.>.vv>....>.>>vv>.>..>..v>..>.v..v.v...v....>>>..v.>v.>v..vv.>>...v>.>.v>>.v..vv";
        "..>v.vv....v.v...vvv>vv.....v>>>>....>>>..vvv..v...>...>v.vv...v>>>..>...v.>>.v.>vv.>v.>vv>>>>v.v>v>>....>>>..v.....>vv.v..vv.>>v..>..vv>.>";
        "v..vv>vv>.v>...>..v.v>..>v....>.....v>.>.v>...>>>vv..>>v..v...>v....>v.vvv.....v.v.v>..>v..v>....>v..>v....vv..>.>v>..>v.>.>vv.>>v.v>v...>>";
        ">....vv>>..v..vvvv>v.>v..v.>.>....v..v>.vv>..>v.....vv>vv.....>vv..v>..vv.>>v>>>>..>..v...........vv......v>v....>v>....v...>>..>...v..>v>v";
        "..v.v>.v>>...v.>>v..>.>..v.>..vv..>.>v>.v...>>>..>v...>.>.vv.v....>.v.v.>.vv..v..v.>>.>>.>.v.v.v....v>.....>v.>>.>..v..>>>.>..v..vv.>v.vv.>";
        ".>..>>.vv.>v...>.>>v>.vv>.vvv>>...>vvv>...>.....vv>v>>.>..v.v>...>..vv>..>..v.>vv.>.v>vv.vv.>....>>...v.....>.>v>.>vv>>.>v..>.v.v....>>>...";
        "vv.>vvv>v.vv>v.v....v>..>>.v..v>>v.........>...>v.>>....v>..>.>.>.>..>v.v>>>v>.>vv.vv.>...>>>.....vv...>..v.v.v.>v.v.v..v.>.>.......>>.>..>";
        ".v>v.v>.>>..>.>...v.v>.>..>...v.>..>...v>>vv..>v>.v..>..>v.v..>vv..v>>v>.vv..v.......>>.>.vv>v.v.v....v>...vv..>..>v..>.vvv>..v...>.v...>>>";
        "vv>v.>>vvv>.>>v.>v.vvvv>>..>.>>.v.v.>..v.>v....>..>...>>>..>>vv>..>v>.........v.v.v.v.>.v>>>>.>.>.v..>.vv....>>.>..>.>..vvvvvv.v...vv>...vv";
        ">>>vv>>>..>v>>>.>.v>v.v>v.v>.....>v>..>....v.vv>vv..>>....v.>.vv>>v>>>v.vv.>vv.v>.v....v>.>.>>..v..>>....v.v>v>..>>.>..vv>...>..v>>..>.>vv>";
        ">>vvvvv..>>..v.v>...v..>>.>>...>.v..>.>>vvvvv....vvv..>.v.....vv...v..>>.vv.v.>vvv..vv.>vv>v.v....>v.>.>..>>>v>v..v.v.vvv....>v.....>>.....";
        ">.v.>vvv>vv>vv.vv>..v.>.>.v..v>v.>.>v..>v>..>.vv.v>...>v..v.....>.v...v>v...v>vv.>vvv..v>>..>>>...>.v...vv..>.v..vv..>vv>>.>....>...vvv....";
        ">>v.v>vv>.vv....>..>...v.>v.vv>>v>>vv.>>>.v.>v..>..v....>...>..>........>...>>...>..>>.>.>>v>..>.>v.v.v>..>vvv>>.>...vv.v>..>>....vv.v.>>..";
        ">v....>v..v>.........>..v.>>.v>.>.>.v.>..v.v.>v>>v>v.v>...>.v>.>>vvvv>.>v...v.v.>.v.>v.vvv.v>v..>>v.vv..v.>v>.>v.>.....v>v..>>.>v.>v>.v..v>";
        "v.>.vv..>vvv.>..v...v>v..v>>>>...vvv.....>>>.v>v.v>..v..v>.>>.vv.v..>>v..v.vv..v..vvv>..v.v.....>..v.v.>v>>v..>>v>v.>vv...>.v.vv>...>>v.v..";
        "v.v.v.v.>v>.>>.....vv>>.v>..>>..v.>vvv.v..v.v..v.>....>v..........vv.>.vv>vv......vv>.v.v..>vvv..>...v>.>v.v..>>.>..>.>>....>>.v..v.v..v.>v";
        ">.vv>.>vv..v>....v.>>>v>>...vv>.v...>v.v.vvv>>..v>.v>>v>.v>>vvvvv>>.v...>v...v......>.>>>.v...>.>>.>>v>.vvv>v.>.>vvv>.....>>vv..>.>>.v>.v>.";
        "....>v....v...>v.>.v..v>..v>....vv.>.vv.>v.>>vv>>.>v.v....vv.v..>....>>.>>....vv.vv....>vv.>>.>...>.>v>vv.....>.>.v>.>.v.>...v>>..vv>..>...";
        "v.v.vv...>vvv>...v..v>.....>>>.v....>>>...v>>.v>vv>v>..>......>>v.>>v.v.>.>vv.vv...>...>v.vv.v>..>.vvv.v>.>..>.>..>v>.>>.v>vv.>>v..v>...>.v";
        ".>..........v.>vv>>.>.>>v.v.v.>vv>...>..>v..>.>>....v>>.v...>>.>vvv...>>v.>.>.>.v..>v>..vvv...v>>>....v..v.v.>..>..vvv>vv...vv>.>>v>v>.>..v";
        "v.....>..>v.>v.>.>...>.....vv>v.>.>>>vv>..v.vv..>>.>>vvvvv>vv..v>.v.>..v.>v...v.>..v>>.>...v>.>.>>vv.>>.v>.v>>>v.>..>v.>v>.>.>>vv>.>v.vv>>.";
        "..>.vv....v>.>..v>..>..v..>v.v.>.>v.>vv.>.vvv>.>>...>....v>vvvv.v>.v.>>>.v..v>.>v.v.v....v..>>>v>..>.>>.v>>>>v>>>v.v..v.v.>>>>....>>...>v.>";
        "......v.>..>..>>.>.v...v...>.>.>>>>vv..>v>>.>.>>.>v>..>>>...>>>v>>.v.>v>>..>v.>.>.>>.vv>v.>>.v...v.vv>>.vv..v..>....v.>..>.>.>vv.>v..>.>>.v";
        "....>......v>..v..>.v>.vv.v.>.vv......v..>.>v..vvv>...v..vv>v.>>......>..v>..v...>v>vv....>>>....vv..>>..v>v>.>..v.v>..v.>v.v.>v>..vvv>>>>>";
        "...>>.>>>>..>v>>..v>v>vv.vv.>v>...>.>>vv....>.v...>>v.vvv...>.v.....>v.vvvv>...v.v.v.v..>>.v.v...>.>.v..........>>>.v...vv.>...>vv>>vv....>";
        "..v..v>>v.>.>vv..>.>>>v.>.v..>>.v>.v>>>>.....v>....>.v>>>>..v>v.v.>v.>>.v.>>>>v.>v.v>.vv>>>.....v..>>v.>.>..>v..vvv...vvv.v.>.v>.v.v.v>.>v>";
        "v>.>v>v..>.....vv..>.v....>v...v>.v...>.....>.>>>.vv..>.v.>...vvv.....>.>vvv>.v..vvv>v>>....>.v..>.....v..>>..>.>...>.v.>>.>.>.>>.>>>>...v.";
        ".v>>>v.>..v...>>..>vv....v.....>v.....>.>>v>.v.v.>..v...v.>..v...v.v..>>>>>vv..v..>>>.>v.>.>.v.vvv.v>.v>v.>...vv..>vv...>....>>>vv.v.vv.>vv";
        "v.v>.v...v..>.>..>v...>.>>.v...>v...v.v..>.vvvv..v.>.vv.vv>>.v>v...>v.>..>>.>v...vv>>v>>>..>.v.>>vv.>>..>>....>....>.>...>.v..v>.....vv...v";
        ">v.>v>>v>..v..v.v..v.>.>.v.vvv.>>v.vv>.....>v....>....v>vv>.v>.vvv>>..v..>>v.>..v.vv..>>.>.v..vv....v..v..v.....>v..vv.vvvv>>...>.....v.vv."
    ]

    let getSeaCucumber char = 
        match char with 
        | '>' -> Some HorizontalSeaCucumber
        | 'v' -> Some VerticalSeaCucumber
        | _ -> None

    let getNextPoint cucumber (x, y) map =
        match cucumber with
        | VerticalSeaCucumber -> 
            let nextY = if y = map.rows - 1 then 0 else y + 1
            (x, nextY)
        | HorizontalSeaCucumber -> 
            let nextX = if x = map.columns - 1 then 0 else x + 1
            (nextX, y)

    let getMap (input:string list) = 

        let initialMap = input 
                      |> List.mapi (fun lineIndex line -> (lineIndex, line))
                      |> List.collect (fun (lineIndex, line) -> line |> Seq.toList |> List.mapi(fun columnIndex char -> ((columnIndex, lineIndex), (getSeaCucumber char))))
                      |> List.filter (fun (point, cucumberOption) -> cucumberOption.IsSome)
                      |> List.map (fun (point, cucumberOption) -> (point, cucumberOption.Value))
                      |> Map.ofList

        {
            map = initialMap
            rows = input.Length
            columns = input[0].Length
        }

    let moveCucumber map (x, y) cucumber =
        let nextPoint = getNextPoint cucumber (x, y) map

        if map.map.ContainsKey nextPoint then
            ((x, y), cucumber)
        else
            (nextPoint, cucumber)

    let isHorizontalCucumber cucumber = 
        match cucumber with
        | VerticalSeaCucumber -> false
        | HorizontalSeaCucumber -> true

    let isVerticalCucumber cucumber = 
        match cucumber with
        | VerticalSeaCucumber -> true
        | HorizontalSeaCucumber -> false

    let step seaMap =
        let middleMapPoints = 
            seaMap.map 
            |> Map.toList
            |> List.map (fun ((x, y), cucumber) -> 
                            if isHorizontalCucumber cucumber then
                                moveCucumber seaMap (x, y) cucumber
                            else
                                ((x, y), cucumber))
            |> Map.ofList

        let middleMap = { seaMap with map = middleMapPoints }

        let finalMapPoints = 
            middleMap.map
            |> Map.toList
            |> List.map (fun ((x, y), cucumber) -> 
               if isVerticalCucumber cucumber then
                   moveCucumber middleMap (x, y) cucumber
               else
                   ((x, y), cucumber))
            |> Map.ofList

        let finalMap = { seaMap with map = finalMapPoints }
        finalMap

    let rec runSteps map steps =
        let nextMap = step map

        if nextMap = map then
            (map, steps + 1)
        else
            runSteps nextMap (steps + 1)

    let initialMap = getMap input

    let finalMap, steps = runSteps initialMap 0

    let result1 = sprintf "Num steps until no changes: %d" steps
    printFirstStarResult result1
